<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Basic workflows for talkr • talkr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Basic workflows for talkr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">talkr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/workflows.html">Basic workflows for talkr</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Basic workflows for talkr</h1>
            
      

      <div class="d-none name"><code>workflows.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">talkr</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>talkr</code> is a package designed for working with
conversational data in R.</p>
</div>
<div class="section level2">
<h2 id="loading-some-data">Loading some data<a class="anchor" aria-label="anchor" href="#loading-some-data"></a>
</h2>
<p>We will be using the IFADV corpus as example data for the workflow of
<code>talkr</code>. This is a corpus consisting of 20 dyadic
conversations in Dutch, published by the Nederlandse Taalunie in 2007
(<a href="https://fon.hum.uva.nl/IFA-SpokenLanguageCorpora/IFADVcorpus/" class="external-link">source</a>)</p>
<p>The snippet below initializes the talkr dataset using the ifadv data.
For more information about the IFADV dataset, see the <a href="https://github.com/elpaco-escience/ifadv" class="external-link">repository link</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span><span class="fu">ifadv</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ifadv/man/ifadv.html" class="external-link">ifadv</a></span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in init(ifadv::ifadv): Column 'uid' already exists in the dataset. This</span></span>
<span><span class="co">#&gt; column will be renamed to `original_uid`.</span></span></code></pre></div>
<p>Essential to any <code>talkr</code> workflow is a minimal set of data
fields. These are the following:</p>
<ul>
<li>
<code>source</code>: the source conversation (a corpus can consist
of multiple sources)</li>
<li>
<code>begin</code>: begin time (in ms) of an utterance</li>
<li>
<code>end</code>: end time (in ms) of an utterance</li>
<li>
<code>utterance</code>: content of an utterance</li>
<li>
<code>participant</code>: the person who produced the utterance</li>
</ul>
<p>The <code><a href="../reference/init.html">init()</a></code> function takes these minimal fields and
generates a <code>uid</code>: a unique identifier at utterance-level
that can be used as a reference to select and filter specific
utterances.</p>
<p>The <code><a href="../reference/init.html">init()</a></code> function can be used to rename columns if
necessary. For example, if the column <code>participant</code> is named
<code>speaker</code>, we can rename it as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">talkr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>             participant <span class="op">=</span> <span class="st">"speaker"</span><span class="op">)</span></span></code></pre></div>
<p>A dataset can contain additional fields. For instance, the IFADV
sample dataset also contain <code>language</code> (which is Dutch) and
<code>utterance_raw</code> (a fuller, less processed version of the
utterance content). It also contains measures related to turn-taking and
timing, including <code>FTO</code> (floor transfer offset, the offset
between current turn and that of a prior participant, in milliseconds)
and <code>freq</code> and <code>rank</code>, frequency measures of the
utterance content.</p>
</div>
<div class="section level2">
<h2 id="workflow-1-quality-control">Workflow 1: Quality control<a class="anchor" aria-label="anchor" href="#workflow-1-quality-control"></a>
</h2>
<div class="section level3">
<h3 id="summary-statistics">Summary statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<p>The <code>report_stats</code> function provides a simple summary of a
dataset, including the total number of utterances, the total duration of
the conversation, the number of participants, and the number of
sources.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/report_stats.html">report_stats</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; ### Corpus-level statistics </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; nr of sources: 20</span></span>
<span><span class="co">#&gt; nr of participants: 40</span></span>
<span><span class="co">#&gt; nr of turns: 14022</span></span>
<span><span class="co">#&gt; mean turn duration (ms): 1257</span></span>
<span><span class="co">#&gt; turns per hour: 2806</span></span>
<span><span class="co">#&gt; total recording (min): 299.9</span></span>
<span><span class="co">#&gt; total recording (hours): 5</span></span>
<span><span class="co">#&gt; total speaking time (min): 293.8</span></span>
<span><span class="co">#&gt; total speaking time (hours): 4.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Conversation-level statistics (per source)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |source          | nr of participants| total recording (ms)| total recording (min)| total speaking time (ms)| total speaking time (min)|</span></span>
<span><span class="co">#&gt; |:---------------|------------------:|--------------------:|---------------------:|------------------------:|-------------------------:|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA10O  |                  2|               899341|                    15|                   829140|                      13.8|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA11Q  |                  2|               899061|                    15|                   884734|                      14.7|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA12S  |                  2|               900000|                    15|                   785323|                      13.1|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA13U  |                  2|               900000|                    15|                   877328|                      14.6|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA14W  |                  2|               900000|                    15|                   796924|                      13.3|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA15Y  |                  2|               899379|                    15|                  1032776|                      17.2|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA16AA |                  2|               900000|                    15|                   974312|                      16.2|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA17AC |                  2|               899961|                    15|                   885257|                      14.8|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA19AG |                  2|               899236|                    15|                   788268|                      13.1|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA1A   |                  2|               899538|                    15|                   879384|                      14.7|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA20AI |                  2|               899145|                    15|                   918466|                      15.3|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA22AL |                  2|               899838|                    15|                   879580|                      14.7|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA24AK |                  2|               900000|                    15|                   887106|                      14.8|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA2C   |                  2|               899635|                    15|                  1097376|                      18.3|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA3E   |                  2|               899091|                    15|                   851393|                      14.2|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA4C   |                  2|               899108|                    15|                   850314|                      14.2|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA6H   |                  2|               899981|                    15|                   889722|                      14.8|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA7B   |                  2|               899664|                    15|                   913682|                      15.2|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA8K   |                  2|               900000|                    15|                   807418|                      13.5|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA9M   |                  2|               899773|                    15|                   802054|                      13.4|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Turn statistics (per source)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |source          | nr of turns| mean turn duration (ms)| shortest turn (ms)| longest turn (ms)| turns per hour|</span></span>
<span><span class="co">#&gt; |:---------------|-----------:|-----------------------:|------------------:|-----------------:|--------------:|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA10O  |         501|                    1655|                233|              3001|           2005|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA11Q  |         792|                    1117|                124|              4188|           3171|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA12S  |         640|                    1227|                173|              3819|           2560|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA13U  |         717|                    1224|                196|              3173|           2868|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA14W  |         721|                    1105|                 97|              3115|           2884|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA15Y  |         770|                    1341|                154|              4973|           3082|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA16AA |         604|                    1613|                292|              3447|           2416|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA17AC |         782|                    1132|                  0|              3453|           3128|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA19AG |         648|                    1216|                136|              2988|           2594|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA1A   |         681|                    1291|                143|              3417|           2725|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA20AI |         758|                    1212|                167|              5472|           3035|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA22AL |         745|                    1181|                143|              3448|           2981|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA24AK |         685|                    1295|                121|              4421|           2740|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA2C   |         765|                    1434|                217|              3415|           3061|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA3E   |         753|                    1131|                175|              3199|           3015|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA4C   |         719|                    1183|                145|              3697|           2879|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA6H   |         683|                    1303|                122|              4786|           2732|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA7B   |         691|                    1322|                197|              3395|           2765|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA8K   |         612|                    1319|                200|              8712|           2448|</span></span>
<span><span class="co">#&gt; |/dutch2/DVA9M   |         755|                    1062|                163|              2909|           3021|</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visual-quality-checks">Visual quality checks<a class="anchor" aria-label="anchor" href="#visual-quality-checks"></a>
</h3>
<p>The <code>plot_quality</code> function provides a visual check of the
nature of the data, by visualizing the distribution of turn durations,
and transition timing.</p>
<p>Transition timing is similar to FTO, but calculated without
additional quality checks: transitions are identified when the
participant changes from one turn to the next. The transition time is
then calculated as the difference between the beginning of the turn of
the new participant, and the end of the turn of the previous one.</p>
<p>By default, <code><a href="../reference/plot_quality.html">plot_quality()</a></code> will plot the entire
dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_quality.html">plot_quality</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Quality plots can also be run for a specific source:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_quality.html">plot_quality</a></span><span class="op">(</span><span class="va">data</span>, source <span class="op">=</span> <span class="st">"/dutch2/DVA8K"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>A quality plot consists of three separate visualizations, all
designed to allow rapid visual inspection and spotting oddities:</p>
<ol style="list-style-type: decimal">
<li><p>A density plot of turn durations. This is normally expected to
look like a distribution that has a peak around 2000ms (2 seconds) and
maximum lengths that do not far exceed 10000ms (10 seconds) (Liesenfeld
&amp; Dingemanse 2022). The goal of this plot is to allow eyeballing of
oddities like turns of extreme durations or sets of turns with the exact
same duration (unlikely in carefully segmented conversational
data).</p></li>
<li><p>A density plot of turn transition times. A plot like this is
expected to look like a normal distribution centered around 0-200ms
(Stivers et al. 2009). Deviations from this may signal problems in the
dataset, for instance due to imprecise or automated annotation
methods.</p></li>
<li><p>A scatterplot of turn transition (x) by turn duration (y). This
combines both distributions and is expected to look like a cloud of
datapoints that is thickest in the middle region. Any standout patterns
(for instance, turns whose duration is equal to their transition time)
are indicative of problems in the segmentation or timing data.</p></li>
</ol>
<p>Each of the three plots can also be generated separately:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">data</span>, colname<span class="op">=</span><span class="st">"duration"</span>, title<span class="op">=</span><span class="st">"Turn durations"</span>,xlab<span class="op">=</span><span class="st">"duration (ms)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">data</span>, colname<span class="op">=</span><span class="st">"FTO"</span>, title<span class="op">=</span><span class="st">"Turn transitions (FTO)"</span>,xlab<span class="op">=</span><span class="st">"FTO (ms)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span><span class="va">data</span>, colname_x<span class="op">=</span><span class="st">"FTO"</span>,colname_y<span class="op">=</span><span class="st">"duration"</span>,title<span class="op">=</span><span class="st">"Turn transitions and durations"</span>,xlab<span class="op">=</span><span class="st">"transition (ms)"</span>, ylab<span class="op">=</span><span class="st">"duration (ms)"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-2-plot-conversations">Workflow 2: Plot conversations<a class="anchor" aria-label="anchor" href="#workflow-2-plot-conversations"></a>
</h2>
<p>Another key use of <code>talkr</code> is to visualize conversational
patterns. A first way to do so is <code><a href="../reference/geom_turn.html">geom_turn()</a></code>, a
ggplot2-compatible geom that visualizes the timing and duration of turns
in a conversation.</p>
<p>We can start by simply visualizing some of the conversations in the
dataset. Here we sample the first four and plot the first minute of
each. We display them together using <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap()</a></code> by
<code>source</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="co"># we simplify participant names</span></span>
<span><span class="va">conv</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>participant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">participant</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>,ordered<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select first four conversations</span></span>
<span><span class="va">these_sources</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">source</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="va">conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">end</span> <span class="op">&lt;</span> <span class="fl">60000</span>, <span class="co"># select first 60 seconds</span></span>
<span>                <span class="va">source</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">these_sources</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># filter to keep only these conversations</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">end</span>, y <span class="op">=</span> <span class="va">participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">begin</span>,</span>
<span>    end <span class="op">=</span> <span class="va">end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_turnPlot.html">theme_turnPlot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">source</span><span class="op">)</span> <span class="co"># let's facet to show the conversations side by side</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/geom_turn_demon1-1.png" width="768"></p>
<p>More often, we will want to plot a single conversation and explore it
in some more detail. Let’s zoom in on one of these first four. If we
plot it without further tweaking, it is not the most helpful: the
conversation is 15 minutes long and it is hard to appreciate its
structure when we put it all on a single line.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">source</span> <span class="op">==</span> <span class="st">"/dutch2/DVA12S"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">end</span>, y <span class="op">=</span> <span class="va">participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">begin</span>,</span>
<span>    end <span class="op">=</span> <span class="va">end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_turnPlot.html">theme_turnPlot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>So what we do is similar to conversational transcripts: we present
the conversation in a left-to-right, top-to-bottom grid. To do so, we
first need to divide the long conversation into a number of shorter
lines. We do this using <code><a href="../reference/add_lines.html">add_lines()</a></code>. By default, this will
divide the conversation into lines of 60000ms each (1 minute), creating
as many lines as needed.</p>
<p>For now, let’s focus on the first 4 minutes, which we can do by
filtering for <code>line_id &lt; 5</code> after we’ve added lines.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">conv</span> <span class="op">&lt;-</span> <span class="va">conv</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/add_lines.html">add_lines</a></span><span class="op">(</span>line_duration <span class="op">=</span> <span class="fl">60000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">source</span> <span class="op">==</span> <span class="st">"/dutch2/DVA12S"</span>,</span>
<span>                <span class="va">line_id</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># limit to the first five lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">line_end</span>, y <span class="op">=</span> <span class="va">line_participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"The first four minutes from DVA12S"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">line_begin</span>, <span class="co"># the begin and end aesthetics are now line-relative</span></span>
<span>    end <span class="op">=</span> <span class="va">line_end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">conv</span><span class="op">$</span><span class="va">line_id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_turnPlot.html">theme_turnPlot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/geom_turn_demo_3-1.png" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can style a plot like this using any available variables. For
instance, we can highlight turns that are produced in overlap:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Turns produced in overlap"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">line_begin</span>,</span>
<span>    end <span class="op">=</span> <span class="va">line_end</span>,</span>
<span>    fill<span class="op">=</span><span class="va">overlap</span>,</span>
<span>    colour<span class="op">=</span><span class="va">overlap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="co"># stop NA value from showing up in legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_colour_discrete</a></span><span class="op">(</span>na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="co"># stop NA value from showing up in legend</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/step10-1.png" width="768">
So far we have just visualized the temporal structure. But
conversational turns typically consist of words and other elements.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Turns produced in overlap"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">line_begin</span>,</span>
<span>    end <span class="op">=</span> <span class="va">line_end</span>,</span>
<span>    fill<span class="op">=</span><span class="va">overlap</span>,</span>
<span>    colour<span class="op">=</span><span class="va">overlap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="co"># stop NA value from showing up in legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_colour_discrete</a></span><span class="op">(</span>na.translate<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="co"># stop NA value from showing up in legend</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/step11-1.png" width="768">
### Looking into tokens</p>
<p>We can start looking into the internal structure of turns by plotting
occurrence of tokens.</p>
<p>To do so, we first need to generate a token-specific dataframe with
<code><a href="../reference/tokenize.html">tokenize()</a></code>. This calculate token frequencies for all tokens
in the selected dataset (all data by default). It also calculates
relative positions in time for individual tokens in a turn. Finally, it
provides a simple positional classification in to <code>only</code> (the
token appears on its own), <code>first</code> (the token is
turn-initial), <code>last</code> (the token is utterance-final), and
<code>middle</code> (the token is not first nor last).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">conv_tokens</span> <span class="op">&lt;-</span> <span class="va">conv</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/tokenize.html">tokenize</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p>With information about tokens in hand, we can start asking questions.
For instance, how does the relative frequency of words relate to their
position in the turn?</p>
<p>To explore this question, let’s look at a shorter excerpt: 1 minute
in total, divided over 4 lines. To do this, we create a dataframe
<code>this_conv</code>, dividing it into 4 lines of 15 seconds each. We
also create a dataframe <code>these_tokens</code> with tokenized turn
elements for the same conversation, divided up in the same way.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">this_conv</span> <span class="op">&lt;-</span> <span class="va">conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_lines.html">add_lines</a></span><span class="op">(</span>line_duration<span class="op">=</span><span class="fl">15000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">source</span> <span class="op">==</span> <span class="st">"/dutch2/DVA12S"</span>,</span>
<span>                <span class="va">line_id</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># let's look at the first three lines</span></span>
<span></span>
<span><span class="va">these_tokens</span> <span class="op">&lt;-</span> <span class="va">conv_tokens</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_lines.html">add_lines</a></span><span class="op">(</span>line_duration<span class="op">=</span><span class="fl">15000</span>, time_columns <span class="op">=</span> <span class="st">"relative_time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">source</span> <span class="op">==</span> <span class="st">"/dutch2/DVA12S"</span>,</span>
<span>                <span class="va">line_id</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">this_conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">line_end</span>, y <span class="op">=</span> <span class="va">line_participant</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Relative frequency of elements within turns"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># we reverse the axis because lines run top to bottom</span></span>
<span>  <span class="fu"><a href="../reference/geom_turn.html">geom_turn</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    begin <span class="op">=</span> <span class="va">line_begin</span>,</span>
<span>    end <span class="op">=</span> <span class="va">line_end</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_token.html">geom_token</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">these_tokens</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">line_relative_time</span>,</span>
<span>                 size<span class="op">=</span><span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (ms)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_turnPlot.html">theme_turnPlot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can also print the content of some of the elements. Here,
we pick the most frequent turn-initial elements for plotting, highlight
them with another layer of <code><a href="../reference/geom_token.html">geom_token()</a></code> and plot the text
using <code>geom_label_repel()</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">these_tokens_first</span> <span class="op">&lt;-</span> <span class="va">these_tokens</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">order</span><span class="op">==</span><span class="st">"first"</span>,</span>
<span>                <span class="va">rank</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Some frequent turn-initial elements"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_token.html">geom_token</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">these_tokens_first</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">line_relative_time</span><span class="op">)</span>,</span>
<span>             color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">these_tokens_first</span>,</span>
<span>                            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">line_relative_time</span>,</span>
<span>                                label<span class="op">=</span><span class="va">token</span><span class="op">)</span>,</span>
<span>                            direction<span class="op">=</span><span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflows_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<p>The <code>init</code> function can also be used to reformat
timestamps. Default is “ms”, which expects milliseconds. ‘%H:%M:%OS’
will format eg. 00:00:00.010 to milliseconds (10). See ‘?strptime’ for
more format examples.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>format_timestamps<span class="op">=</span><span class="st">"ms"</span><span class="op">)</span></span></code></pre></div>
<p>Token frequencies are calculated over the entire dataset. If you want
source-specific data, you can filter the source prior to
tokenization:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tokens_DVA9M</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">source</span> <span class="op">==</span> <span class="st">"/dutch2/DVA9M"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tokenize.html">tokenize</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tokens_DVA9M</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Liesenfeld, Andreas, and Mark Dingemanse. 2022. ‘Building and
Curating Conversational Corpora for Diversity-Aware Language Science and
Technology’. In Proceedings of the 13th Conference on Language Resources
and Evaluation (LREC 2022), 1178–92. Marseille. <a href="doi:10.48550/arXiv.2203.03399" class="uri">doi:10.48550/arXiv.2203.03399</a>.</li>
<li>Stivers, Tanya, N. J. Enfield, Penelope Brown, C. Englert, Makoto
Hayashi, Trine Heinemann, Gertie Hoymann, Federico Rossano, J. P. de
Ruiter, Kyung-Eun Yoon, and Stephen C. Levinson. 2009. ‘Universals and
Cultural Variation in Turn-Taking in Conversation’. Proceedings of the
National Academy of Sciences 106 (26): 10587–92. <a href="doi:10.1073/pnas.0903616106" class="uri">doi:10.1073/pnas.0903616106</a>.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Dingemanse, Barbara Vreede, Eva Viviani, Pablo Rodríguez-Sánchez, Netherlands eScience Center.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
